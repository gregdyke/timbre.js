(function(e){"use strict";function t(t){e.Object.call(this,2,t)}var n=e.fn;n.extend(t,e.Object);var i=t.prototype;Object.defineProperties(i,{gen:{set:function(e){"object"==typeof e&&e.process&&(this._.gen=e)},get:function(){return this._.gen}}}),i.process=function(e){var t=this._;return this.tickID!==e&&(this.tickID=e,t.gen&&(this._.gen.process(this.cells[1],this.cells[2]),n.outputSignalAR(this))),this};var s,r=function(){function t(t){var n=Math.ceil(Math.log(1.5*e.samplerate)*Math.LOG2E);this.cell=new e.fn.SignalArray(e.cellsize),this.time=125,this.feedback=.25,this.buffer=new e.fn.SignalArray(1<<n),this.mask=(1<<n)-1,this.wet=.45,this.readIndex=0,this.writeIndex=0|this.time/1e3*e.samplerate,t&&this.setParams(t)}var n=t.prototype;return n.setParams=function(t){return t.time&&(this.time=t.time,this.writeIndex=this.readIndex+(0|.001*this.time*e.samplerate)),t.feedback&&(this.feedback=t.feedback),t.wet&&(this.wet=t.wet),this},n.process=function(e,t){var n,i,s,r,a,o,u,c,l,h;for(n=this.cell,i=this.buffer,s=this.writeIndex,r=this.readIndex,a=this.feedback,u=this.wet,c=1-this.wet,l=0,h=n.length;h>l;++l)o=i[r],i[s]=e[l]-o*a,n[l]=e[l]*c+o*u,s+=1,r+=1;if(t)for(l=0;h>l;++l)e[l]=n[l];return this.writeIndex=s&this.mask,this.readIndex=r&this.mask,n},t}();"browser"===e.envtype?(window.pico||(window.pico={}),s=window.pico):"node"===e.envtype&&(global.pico||(global.pico={}),s=global.pico),s&&(Object.defineProperties(s,{env:{get:function(){return e.env}},samplerate:{get:function(){return e.samplerate}},channels:{get:function(){return e.channels}},cellsize:{get:function(){return e.cellsize}},isPlaying:{get:function(){return e.isPlaying}},DelayNode:{value:r}}),n.register("pico.js",t))})(timbre);
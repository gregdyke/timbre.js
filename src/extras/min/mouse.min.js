(function(e){"use strict";function t(t){return s?s:(s=this,e.Object.call(this,1,t),this.X=new e.ChannelObject(this),this.Y=new e.ChannelObject(this),this.cells[3]=this.X.cell,this.cells[4]=this.Y.cell,i.fixKR(this),void 0)}function n(n){e.Object.call(this,1,n),s||(s=new t([])),i.fixKR(this)}if("browser"===e.envtype){var i=e.fn,s=null;i.extend(t);var r=0,a=0,o=function(e){s._.emit("click",e)},u=function(e){s._.emit("mousedown",e)},c=function(e){for(var t=r=e.clientX/window.innerWidth,n=a=e.clientY/window.innerHeight,i=s.cells[3],o=s.cells[4],u=0,c=i.length;c>u;++u)i[u]=t,o[u]=n},l=function(e){s._.emit("mouseup",e)},h=t.prototype;h.start=function(){return window.addEventListener("click",o,!0),window.addEventListener("mousedown",u,!0),window.addEventListener("mousemove",c,!0),window.addEventListener("mouseup",l,!0),this},h.stop=function(){return window.removeEventListener("click",o,!0),window.removeEventListener("mousedown",u,!0),window.removeEventListener("mousemove",c,!0),window.removeEventListener("mouseup",l,!0),this},h.play=h.pause=function(){return this},i.register("mouse",t),i.extend(n),Object.defineProperties(n.prototype,{min:{set:function(e){var t=this._;t.min=e,t.delta=t.max-t.min,t.map.bang()},get:function(){return this._.min}},max:{set:function(e){var t=this._;t.max=e,t.delta=t.max-t.min,t.map.bang()},get:function(){return this._.max}},curve:{set:function(e){var t=this._;if(f[e]){var n=f[e];t.map.map=function(e){return n(t,e)},t.map.bang(),t.curveName=e}},get:function(){return this._.curveName}}}),n.prototype.start=function(){return s.start(),this},n.prototype.stop=function(){return s.stop(),this},n.prototype.process=function(e){return this._.map.process(e),this};var f={lin:function(e,t){return t*e.delta+e.min},exp:function(e,t){var n=0>e.min?1e-6:e.min;return Math.pow(e.max/n,t)*n},sqr:function(e,t){return t*t*e.delta+e.min},cub:function(e,t){return t*t*t*e.delta+e.min}};i.register("mouse.x",function(t){var i=new n(t),r=i._;r.min=0,r.max=1,r.delta=1,r.curveName="lin";var a=f.lin;return r.map=e("map",{map:function(e){return a(r,e)}},s.X),i.cells[0]=r.map.cells[0],i}),i.register("mouse.y",function(t){var i=new n(t),r=i._;r.min=0,r.max=1,r.delta=1,r.curveName="lin";var a=f.lin;return r.map=e("map",{map:function(e){return a(r,e)}},s.Y),i.cells[0]=r.map.cells[0],i})}})(timbre);
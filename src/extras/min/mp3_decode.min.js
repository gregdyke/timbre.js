/*!
 * timbre.mp3_decode.js
 * http://skratchdot.com/projects/timbre.mp3_decode.js/
 *
 * Copyright (c) 2013 skratchdot
 * Licensed under the MIT license.
 */
"undefined"!=typeof timbre&&"undefined"!=typeof Mad&&"browser"===timbre.envtype&&function(e){e.modules.Decoder.mp3_decode=function(){var t=function(e,t,n){var i,s,r,a,o,u,c,l,h,f,p,v,d,m,g,y,_=0,b=[],w=0;try{for(a=new Mad.ArrayBuffers.ArrayStream(e),o=new Mad.MP3File(a),u=o.getMpegStream(),c=new Mad.Synth,l=new Mad.Frame,l=Mad.Frame.decode(l,u);null!==l;){if(c.frame(l),y||(h=c.pcm.channels,f=c.pcm.samplerate,y=!0),_+=c.pcm.length,b.push({mixdown:void 0,bufferL:void 0,bufferR:void 0}),b[w].mixdown=new Float32Array(c.pcm.length),2===h)for(b[w].bufferL=new Float32Array(c.pcm.length),b[w].bufferR=new Float32Array(c.pcm.length),i=0;c.pcm.length>i;i++)r=b[w].bufferL[i]=c.pcm.samples[0][i],r+=b[w].bufferR[i]=c.pcm.samples[1][i],b[w].mixdown[i]=.5*r;else if(1===h)for(i=0;c.pcm.length>i;i++)b[w].mixdown[i]=c.pcm.samples[0][i];l=Mad.Frame.decode(l,u),w++}}catch(A){}if(0===_||1>h||h>2)return t(!1);for(d=new Float32Array(_),2===h&&(m=new Float32Array(_),g=new Float32Array(_)),t({samplerate:f,channels:h,buffer:[d,m,g],duration:_/f}),v=0,i=0;b.length>i;i++)for(p=b[i],s=0;p.mixdown.length>s;s++)d[v]=p.mixdown[s],2===h&&(m[v]=p.bufferL[s],g[v]=p.bufferR[s]),v++;n()};return function(n,i,s){"string"==typeof n?e.modules.Decoder.getBinaryWithPath(n,function(e){t(e,i,s)}):t(n,i,s)}}()}(timbre);